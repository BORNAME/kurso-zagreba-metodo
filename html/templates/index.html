        {% extends "layout.html" %}
        {% block content %}

          {% for leciono in enhavo.lecionoj %}
          {% set leciono_loop = loop %}
          
            <h2 id="leciono{{leciono_loop.index}}">
              {{leciono_loop.index}}.
              {% for vorto in leciono.teksto.titolo %}
                {% if vorto is string -%}
                  {{vorto}}
                {%- elif vorto is iterable -%}
                  <a href="#" data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                    <table>
                    {# Loop only if there are multiple roots. #}
                    {% if vorto|length > 1 -%} 
                      {% for radiko in vorto -%} 
                        {% if radiko|lower in enhavo.vortaro -%}
                        <tr>
                          <td>{{ radiko }}</td>
                          <td>{{ enhavo.vortaro[radiko|lower] }}</td>
                        </tr>
                        {% endif %} 
                      {%- endfor %}
                    {% endif %} 
                    {% if vorto|join|lower in enhavo.vortaro -%}
                      <tr>
                        <td>{{ vorto|join|lower }}</td>
                        <td>{{ enhavo.vortaro[vorto|join|lower] }}</td>
                      </tr>
                    {% elif vorto|join in enhavo.vortaro -%}
                      <tr>
                        <td>{{ vorto|join }}</td>
                        <td>{{ enhavo.vortaro[vorto|join] }}</td>
                      </tr>
                    {% endif %} 
                    </table>
                  ">{{ vorto|join }}</a>
                {% endif %} 
              {% endfor %}
            </h2>
            <p class="alert alert-info" role="alert">{{ enhavo.vortaro['Alklaku la vortojn por vidi ilian tradukon.'] }}</p>
            {% for paragrafo in leciono.teksto.paragrafoj %}
            <p>
              {% for vorto in paragrafo -%}
                {% if vorto is string -%}
                  {{vorto}}
                {%- elif vorto is iterable -%}
                  <a href="javascript:" data-toggle="tooltip" data-html="true" data-placement="bottom" title="
                    <table>
                    {# Loop only if there are multiple roots. #}
                    {% if vorto|length > 1 -%} 
                      {% for radiko in vorto -%} 
                        {% if radiko|lower in enhavo.vortaro -%}
                        <tr>
                          <td>{{ radiko }}</td>
                          <td>{{ enhavo.vortaro[radiko|lower] }}</td>
                        </tr>
                        {% endif %} 
                      {%- endfor %}
                    {% endif %} 
                    {% if vorto|join|lower in enhavo.vortaro -%}
                      <tr>
                        <td>{{ vorto|join|lower }}</td>
                        <td>{{ enhavo.vortaro[vorto|join|lower] }}</td>
                      </tr>
                    {% elif vorto|join in enhavo.vortaro -%}
                      <tr>
                        <td>{{ vorto|join }}</td>
                        <td>{{ enhavo.vortaro[vorto|join] }}</td>
                      </tr>
                    {% endif %} 
                    </table>
                  ">{{ vorto|join }}</a>
                {%- else %} 
                {% endif %} 
              {%- endfor %}
            </p>
            {% endfor %}

            <h3 id="gramatiko{{leciono_loop.index}}">{{ enhavo.vortaro['Gramatiko'] }} / Gramatiko</h3>

            {{leciono.gramatiko|markdown}} 

            <h3 id="ekzercoj{{leciono_loop.index}}">{{ enhavo.vortaro['Ekzercoj'] }} / Ekzercoj</h3>

            <p class="alert alert-info" role="alert">{{ enhavo.vortaro['Por la esperantaj literoj vi povas anka≈≠ skribi cx, gx, hx, jx, sx und ux.'] }}</p>

            {% set tasko = 'Traduku' %}
            {% set ekzerco_index = 1 %}
            {% set form_id = leciono_loop.index ~ '-' ~ ekzerco_index %}

            <h4> {{enhavo.vortaro[tasko]}} / {{tasko}} </h4>
            <form id="form-{{form_id}}" class="form-horizontal">

              {% for vico in leciono.ekzercoj[tasko] %}

                {% set vico_loop = loop %}
                {% set id = 'vico-' ~ leciono_loop.index ~ '-' ~ ekzerco_index ~ '-' ~ vico_loop.index %}
                <div id="form-group-{{id}}" class="form-group has-error has-feedback">
                  {% for esperante,fontlingve in vico.items() %}
                    <label class="control-label col-sm-2" for="{{id}}" data-toggle="tooltip" data-placement="bottom" title="{{ esperante }}" >{{fontlingve}}:</label>
                    <div class="col-sm-10">
                      <input id="{{id}}" class="form-control" type="text" size="{{esperante|length}}" data-solvo="{{esperante}}"/>
                      <span id="glyphicon-{{id}}" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                    </div>
                  {% endfor %}
                </div>
              {% endfor %}

              <input type="button" class="btn btn-success solvu" value="{{enhavo.vortaro['Solvu']}}" data-form-id="{{ form_id }}" />
              <input type="button" class="btn btn-danger forigu" value="{{enhavo.vortaro['Forigu']}}" data-form-id="{{ form_id }}" />
            </form>

            {% set tasko = 'Kompletigu la frazojn' %}
            {% set ekzerco_index = 2 %}
            {% set form_id = leciono_loop.index ~ '-' ~ ekzerco_index %}

            <h4> {{enhavo.vortaro[tasko]}} / {{tasko}} </h4>

            <form id="form-{{form_id}}" class="form-inline">
              <ol class="tasko">
                {% for vico in leciono.ekzercoj[tasko] %}
                {% set vico_loop = loop %}
                <li>
                  {%- for parto in vico -%}
                    {% set parto_loop = loop %}
                    {% set id = 'vico-' ~ leciono_loop.index ~ '-' ~ ekzerco_index ~ '-' ~ vico_loop.index ~ '-' ~ parto_loop.index %}
                    {%- for klavo,valoro in parto.items() -%}
                      {%- if klavo == 'videbla' -%}
                        {%- if valoro -%}
                          {{valoro}}
                        {%- else %} {% endif -%} 
                      {%- elif klavo == 'solvo' -%}
                        <div id="form-group-{{id}}" class="form-group has-error has-feedback">
                          <input id="{{id}}" type="text" class="form-control" size="{{valoro|length}}" data-solvo="{{valoro}}" />
                          <span id="glyphicon-{{id}}" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                        </div>
                      {%- endif -%} 
                   {%- endfor -%}
                  {%- endfor -%}
                </li>
                {% endfor %}
              </ol>
              <input type="button" class="btn btn-success solvu" value="{{enhavo.vortaro['Solvu']}}" data-form-id="{{ form_id }}" />
              <input type="button" class="btn btn-danger forigu" value="{{enhavo.vortaro['Forigu']}}" data-form-id="{{ form_id }}" />
            </form>

            {% set tasko = 'Traduku kaj respondu' %}
            {% set ekzerco_index = 3 %}
            {% set form_id = leciono_loop.index ~ '-' ~ ekzerco_index %}
            <h4> {{enhavo.vortaro[tasko]}} / {{tasko}} </h4>


            <ol class="tasko">
              {% for vico in leciono.ekzercoj[tasko] %}
                {% set vico_loop = loop %}
                {% set form_id = leciono_loop.index ~ '-' ~ ekzerco_index ~ '-' ~ vico_loop.index %}
              <li>

                {{vico.demando}}

                <form id="form-{{form_id}}" class="form-horizontal">

                  {% for duopo in vico.rektatraduko %}
                    {% set duopo_loop = loop %}
                    {% set id = leciono_loop.index ~ '-' ~ ekzerco_index ~ '-' ~ vico_loop.index ~ '-' ~ duopo_loop.index %}
                    {% if duopo is mapping %}
                      {% for esperante, fontlingve in duopo.items() %}
                        <div id="form-group-{{id}}" class="form-group has-error has-feedback">
                          <label class="control-label col-sm-2" for="{{id}}" 
                            data-toggle="tooltip" data-placement="bottom" title="{{esperante}}">{{fontlingve}}:</label>
                          <div class="col-sm-10">
                            <input id="{{id}}" class="form-control" type="text" size="{{esperante|length}}" data-solvo="{{esperante}}"/>
                            <span id="glyphicon-{{id}}" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                          </div>
                        </div>
                        {% endfor %}
                      {%- else %} 
                        <div class="form-group">
                          <label class="control-label col-sm-2">{{duopo}}</label>
                        </div>
                      {% endif -%} 
                  {% endfor %}

                  <input type="button" class="btn btn-success solvu" value="{{enhavo.vortaro['Solvu']}}" data-form-id="{{ form_id }}" />
                  <input type="button" class="btn btn-danger forigu" value="{{enhavo.vortaro['Forigu']}}" data-form-id="{{ form_id }}" />
                </form>

              </li>
              {% endfor %}
            </ol>

          {% endfor %}

        {% endblock %}
